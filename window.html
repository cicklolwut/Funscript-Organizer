<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="popup.css">
  <link rel="stylesheet" href="window.css">
</head>
<body class="window-mode">
  <div class="container">
    <div class="header-container">
      <div class="tab-container">
        <div class="tab-buttons">
          <button class="tab-button active" data-tab="tracker">Tracker</button>
          <button class="tab-button" data-tab="config">Settings</button>
        </div>
      </div>
    </div>

    <!-- Tracker Tab -->
    <div id="tracker-tab" class="tab-content active">
      <h2>Download Tracker</h2>
      
      <div class="stats">
        <div class="stat-item">
          <span class="stat-label">Unmatched Files:</span>
          <span id="unmatched-count">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Matched Pairs:</span>
          <span id="matched-count">0</span>
        </div>
      </div>

      <div id="normal-view" class="columns">
        <div class="column">
          <h3>Funscript Files</h3>
          <div id="funscript-list" class="file-list"></div>
        </div>
        
        <div class="column">
          <h3>Video Files</h3>
          <div id="video-list" class="file-list"></div>
        </div>
      </div>

      <div id="rename-view" class="rename-view hidden">
        <div class="rename-header">
          <button id="cancel-rename" class="cancel-rename-btn">← Cancel</button>
          <div id="rename-base-name" class="rename-base-name"></div>
          <button id="edit-base-name" class="edit-base-name-btn">Edit</button>
        </div>
        <div class="rename-column">
          <div class="rename-column-header">
            <h3 id="rename-column-title">Files to rename</h3>
            <label class="is-variant-label" id="is-variant-label" style="display: none;">
              Is Variant <input type="checkbox" id="is-variant-checkbox" />
            </label>
          </div>
          <div id="rename-list" class="file-list"></div>
        </div>
      </div>

      <div id="group-view" class="group-view hidden">
        <div class="group-header">
          <button id="cancel-group" class="cancel-group-btn">← Cancel</button>
          <div id="group-base-name" class="group-base-name"></div>
          <button id="edit-group-base-name" class="edit-group-base-name-btn">Edit</button>
        </div>
        <div class="group-column">
          <h3>Select funscripts to group together</h3>
          <div id="group-list" class="file-list"></div>
        </div>
        <div class="group-actions">
          <button id="confirm-group" class="confirm-group-btn">Confirm Grouping</button>
        </div>
      </div>

      <div class="actions">
        <button id="clear-matched">Clear Matched</button>
        <button id="refresh">Refresh</button>
      </div>
    </div>

    <!-- Settings Tab -->
    <div id="config-tab" class="tab-content">
      <h2>Settings</h2>
      
      <div class="config-section">
        <h3>Auto-Matching</h3>
        <label class="checkbox-label">
          <input type="checkbox" id="auto-remove-matches" checked />
          Automatically remove matched pairs
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-notifications" checked />
          Show notifications for new files
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="move-matched-files" />
          Move matched files to folder
        </label>
        <label class="checkbox-label" id="organize-subfolders-label" style="display: none;">
          <input type="checkbox" id="organize-in-subfolders" />
          Organize in subfolders by base name
        </label>
      </div>
      
      <div class="config-section">
        <h3>Watched Folders</h3>
        <p class="config-description">
          Add folders to automatically detect new funscript and video files
        </p>
        
        <div class="folder-input-container">
          <input type="text" id="folder-path-input" placeholder="/home/user/Downloads" />
          <button id="add-folder-btn">Add Folder</button>
          <button id="browse-folder-btn">Browse</button>
        </div>
        
        <div id="watched-folders-list" class="watched-folders">
          <!-- Dynamically populated -->
        </div>
      </div>
      
      <div class="config-section" id="matched-folder-section" style="display: none;">
        <h3>Matched Files Folder</h3>
        <p class="config-description">
          Matched files will be moved to this folder automatically
        </p>
        
        <div class="folder-input-container">
          <input type="text" id="matched-folder-input" placeholder="/home/user/Matched" />
          <button id="set-matched-folder-btn">Set Folder</button>
          <button id="browse-matched-folder-btn">Browse</button>
        </div>
        
        <div id="matched-folder-display" class="watched-folders" style="display: none;">
          <!-- Will show the current matched folder -->
        </div>
      </div>
      
      <div class="config-section">
        <h3>Native Host Status</h3>
        <div id="native-host-status" class="status-indicator">
          <span class="status-dot"></span>
          <span class="status-text">Checking...</span>
        </div>
        <button id="test-native-host">Test Connection</button>
      </div>
      
      <div class="config-section">
        <h3>Appearance</h3>
        
        <!-- Theme Selection -->
        <div class="setting-group">
          <label class="setting-label">Theme:</label>
          <select id="theme-mode" class="setting-select">
            <option value="auto">Auto (System)</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </div>

        <!-- Font Size -->
        <div class="setting-group">
          <label class="setting-label">Font Size:</label>
          <select id="font-size" class="setting-select">
            <option value="small">Small</option>
            <option value="medium">Medium</option>
            <option value="large">Large</option>
          </select>
        </div>

        <!-- Advanced Theming -->
        <div class="theming-section">
          <button id="toggle-theming" class="theming-toggle">Advanced Theming ▼</button>
          <div id="theming-controls" class="theming-controls hidden">
            
            <!-- Saved Themes -->
            <div class="setting-group">
              <label class="setting-label">Saved Themes:</label>
              <div class="theme-management">
                <select id="saved-themes" class="setting-select">
                  <option value="">Select a theme...</option>
                </select>
                <button id="load-theme" class="small-btn">Load</button>
                <button id="save-theme" class="small-btn">Save</button>
                <button id="delete-theme" class="small-btn">Delete</button>
              </div>
            </div>

            <!-- Color Controls -->
            <div class="color-groups">
              <div class="color-group">
                <h4>Background Colors</h4>
                <div class="color-control">
                  <label>Primary:</label>
                  <input type="color" id="bg-primary" value="#f5f5f5">
                </div>
                <div class="color-control">
                  <label>Secondary:</label>
                  <input type="color" id="bg-secondary" value="#ffffff">
                </div>
                <div class="color-control">
                  <label>Tertiary:</label>
                  <input type="color" id="bg-tertiary" value="#f9f9f9">
                </div>
              </div>

              <div class="color-group">
                <h4>Text Colors</h4>
                <div class="color-control">
                  <label>Primary:</label>
                  <input type="color" id="text-primary" value="#333333">
                </div>
                <div class="color-control">
                  <label>Secondary:</label>
                  <input type="color" id="text-secondary" value="#666666">
                </div>
                <div class="color-control">
                  <label>Tertiary:</label>
                  <input type="color" id="text-tertiary" value="#999999">
                </div>
              </div>

              <div class="color-group">
                <h4>Accent Colors</h4>
                <div class="color-control">
                  <label>Green:</label>
                  <input type="color" id="accent-green" value="#4CAF50">
                </div>
                <div class="color-control">
                  <label>Blue:</label>
                  <input type="color" id="accent-blue" value="#2196F3">
                </div>
                <div class="color-control">
                  <label>Red:</label>
                  <input type="color" id="accent-red" value="#f44336">
                </div>
                <div class="color-control">
                  <label>Yellow:</label>
                  <input type="color" id="accent-yellow" value="#ffc107">
                </div>
                <div class="color-control">
                  <label>Orange:</label>
                  <input type="color" id="accent-orange" value="#FF9800">
                </div>
              </div>

              <div class="color-group">
                <h4>Border Colors</h4>
                <div class="color-control">
                  <label>Primary:</label>
                  <input type="color" id="border-primary" value="#e0e0e0">
                </div>
                <div class="color-control">
                  <label>Secondary:</label>
                  <input type="color" id="border-secondary" value="#dddddd">
                </div>
              </div>
            </div>

            <div class="theming-actions">
              <button id="reset-theme" class="reset-btn">Reset to Default</button>
              <button id="apply-theme" class="apply-btn">Apply Changes</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>